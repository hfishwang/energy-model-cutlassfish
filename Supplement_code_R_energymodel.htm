<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=big5">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:新細明體;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:細明體;
	panose-1:2 2 5 9 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"\@新細明體";
	panose-1:2 1 6 1 0 1 1 1 1 1;}
@font-face
	{font-family:"\@細明體";
	panose-1:2 1 6 9 0 1 1 1 1 1;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Calibri",sans-serif;}
h1
	{mso-style-link:"標題 1 字元";
	margin-right:0cm;
	margin-left:0cm;
	font-size:24.0pt;
	font-family:"新細明體",serif;
	font-weight:bold;}
h3
	{mso-style-link:"標題 3 字元";
	margin-right:0cm;
	margin-left:0cm;
	font-size:13.5pt;
	font-family:"新細明體",serif;
	font-weight:bold;}
h4
	{mso-style-link:"標題 4 字元";
	margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"新細明體",serif;
	font-weight:bold;}
p
	{margin-right:0cm;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"新細明體",serif;}
code
	{font-family:細明體;}
pre
	{mso-style-link:"HTML 預設格式 字元";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:細明體;}
span.1
	{mso-style-name:"標題 1 字元";
	mso-style-link:"標題 1";
	font-family:"新細明體",serif;
	font-weight:bold;}
span.3
	{mso-style-name:"標題 3 字元";
	mso-style-link:"標題 3";
	font-family:"新細明體",serif;
	font-weight:bold;}
span.4
	{mso-style-name:"標題 4 字元";
	mso-style-link:"標題 4";
	font-family:"新細明體",serif;
	font-weight:bold;}
span.HTML
	{mso-style-name:"HTML 預設格式 字元";
	mso-style-link:"HTML 預設格式";
	font-family:細明體;}
span.hljs-keyword
	{mso-style-name:hljs-keyword;}
span.hljs-string
	{mso-style-name:hljs-string;}
span.hljs-number
	{mso-style-name:hljs-number;}
span.hljs-comment
	{mso-style-name:hljs-comment;}
.MsoChpDefault
	{font-family:"Calibri",sans-serif;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:1.0cm 28.3pt 72.0pt 42.55pt;
	layout-grid:18.0pt;}
div.WordSection1
	{page:WordSection1;}
-->
</style>

</head>

<body lang=ZH-TW style='text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:18.0pt'>

<p class=MsoNormal><span lang=EN-US style='font-size:20.0pt;font-family:"Times New Roman",serif'>Supplement
for: </span><span lang=EN-US style='font-size:20.0pt;font-family:"Times New Roman",serif'>Temperature-induced
within-species variation in growth and reproduction revealed by an energy-based
model</span></p>

<p class=MsoNormal style='margin-bottom:9.0pt'><b><span lang=EN-US
style='font-family:"Times New Roman",serif'>Hui-Yu Wang, Hideyasu Shimadzu,
Hsiu-Chin Lin, Ulf Dieckmann, Mikko Heino, Yongjun Tian*, and Peng Sun*</span></b></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>This
supplement file provides some lines of essential R code used for the paper.</span></p>

<p class=MsoNormal><b><span lang=EN-US style='font-family:"Times New Roman",serif'>Required
packages</span></b></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>library(bbmle)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>library(faraway)</span></p>

<h3><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman",serif'>Data
preparation</span></h3>

<pre><code><span lang=EN-US style='font-family:"Times New Roman",serif'>data0 = read.table(&quot;Cutlassfish_combined_data_2021.txt&quot;,header=TRUE,na.strings=&quot;NA&quot;)</span></code></pre><pre><code><span
lang=EN-US style='font-family:"Times New Roman",serif'>data0$soma = data0$total_w-data0$gonad_w</span></code></pre><pre><code><span
lang=EN-US style='font-family:"Times New Roman",serif'>data0$soma[which(is.na(data0$soma))] = data0$total_w[which(is.na(data0$soma))] </span></code></pre><pre><code><span
lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #soma wt = total wt for immature fish</span></code></pre>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>data0$soma1
= data0$soma/53.25&nbsp; </span><code><span lang=EN-US style='font-family:"Times New Roman",serif'>#normalize
soma weight by average somatic weight at age 2 </span></code></p>

<h3><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman",serif'>Estimation
of age-at-50 % maturity</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>##mean
A50 for all stocks</span></p>

<p class=MsoNormal style='text-indent:24.0pt'><span lang=EN-GB
style='font-family:"Times New Roman",serif'>mod1 =
glm(I(maturity==&quot;M&quot;)~round(age),family=binomial,data=data0)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A50_all
= (log(1)-mod1$coef[1]) /mod1$coef[2]</span></p>

<h3><span lang=EN-US style='font-size:12.0pt;font-family:"Times New Roman",serif'>Parameter
estimation</span></h3>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>##
the model form of somatic growth, w_t</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>w
= function(a, alp, t, w0){</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;
(w0^(1-alp) + a*(1-alp)*t)^{1/(1-alp)}</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>}</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>ssr0
= function(a, alp){</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;
t = round(age)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;
s = soma1 </span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;
w0 = mean(s[t==0], na.rm=T)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;
ry = log(s) - log(w(a, alp, t+0.5, w0))</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;sum(ry^2,
na.rm=T)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>}</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>################</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>##
fitting a soma model for each location</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>################</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>results
= list()</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>loc
= levels(data0$site)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>for(i
in 1:length(loc)){</span></p>

<p class=MsoNormal style='margin-left:12.0pt'><span lang=EN-US
style='font-family:"Times New Roman",serif'>results[[i]] = mle2(ssr0,
start=list(a=1,alp=0.5), data=subset(data0, site==loc[i]), lower = c(a=0.0001,alp=0.0001),
upper=c(a=20,alp=0.999), method=&quot;L-BFGS-B&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>}</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>##
the estimated parameters: a and alpha</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>names(results)
= loc</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>sapply(results,
coef)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>asite
= c(0.939,0.928,0.743,0.965,0.884)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>alpsite
= c(0.89,0.84,0.882,0.859,0.957)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>##
the model form of gonadic growth, g_t</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>g
= function(gam,b, t){</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a
= asite[i]</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alp
= alpsite[i]</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(t&gt;=1){</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wt
= w(a, alp, t, w0)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wt1
= w(a, alp, t-1, w0) </span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (b/(a*(1-alp
+ gam)))*(wt^(1-alp+gam)-wt1^(1-alp+gam))}</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>}</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>ssr1
= function(gam,b){</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; t
= round(age)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; z
= gonad_w /53.25 &nbsp;#standardize gt</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rg
= log(z) - log(g(gam,b,t+0.5))</span></p>

<p class=MsoNormal style='text-indent:24.0pt'><span lang=EN-US
style='font-family:"Times New Roman",serif'>sum(rg^2,na.rm=T)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>}</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>################</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>##
fitting a gonadic model for each location</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>################</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>results_b
= list()</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>for(i
in 1:length(loc)){</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>locdata
= subset(data0, site==loc[i])</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>s
= locdata$soma1&nbsp;&nbsp; </span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>w0
= mean(s[round(locdata$age)==0], na.rm=T)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>results_b[[i]]
= mle2(ssr1, start=list(gam=1.2,b=0.01), data=subset(locdata,maturity==&quot;M&quot;),lower
= c(gam=0.0001,b=0.0001), upper=c(gam=20,b=20), method=&quot;L-BFGS-B&quot;)</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>}</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>##
the estimated parameters: b and gamma</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>names(results_b)
= loc</span></p>

<p class=MsoNormal><span lang=EN-US style='font-family:"Times New Roman",serif'>sapply(results_b,
coef)</span></p>

</div>

</body>

</html>
